# MAGENTO UPGRADE CRITICAL ERROR LOGS






######## ISSUE WITH DATABASE UPON UPGRADE
[2020-10-28 22:47:05] report.CRITICAL: Item (Magento\Framework\View\Element\UiComponent\DataProvider\Document) with the same ID "1" already exists. {"exception":"[object] (Exception(code: 0): Item (Magento\\Framework\\View\\Element\\UiComponent\\DataProvider\\Document) with the same ID \"1\" already exists. at /var/www/vendor/magento/framework/Data/Collection.php:405)"} []
######## SOLUTION
_cms_block
_cms_page
Remove the Duplicate Primary Keys Entries from Table block.

######## ISSUE WITH DATABASE UPON UPGRADE
[2020-10-30 11:01:49] report.CRITICAL: SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`magentoprod`.`****_report_viewed_product_index`, CONSTRAINT `****_REPORT_VIEWED_PRD_IDX_PRD_ID_****_SEQUENCE_PRD_SEQUENCE_VAL` FOREIGN KEY (`product_id`) REFERENCES `****_sequence_product` (`), query was: INSERT  INTO `****_report_viewed_product_index` (`visitor_id`,`product_id`,`store_id`) VALUES (?, ?, ?) ON DUPLICATE KEY UPDATE `visitor_id` = VALUES(`visitor_id`), `product_id` = VALUES(`product_id`), `store_id` = VALUES(`store_id`) {"exception":"[object] (Zend_Db_Statement_Exception(code: 23000): SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`magentoprod`.`****_report_viewed_product_index`, CONSTRAINT `****_REPORT_VIEWED_PRD_IDX_PRD_ID_****_SEQUENCE_PRD_SEQUENCE_VAL` FOREIGN KEY (`product_id`) REFERENCES `****_sequence_product` (`), query was: INSERT  INTO `****_report_viewed_product_index` (`visitor_id`,`product_id`,`store_id`) VALUES (?, ?, ?) ON DUPLICATE KEY UPDATE `visitor_id` = VALUES(`visitor_id`), `product_id` = VALUES(`product_id`), `store_id` = VALUES(`store_id`) at /var/www/vendor/magento/zendframework1/library/Zend/Db/Statement/Pdo.php:235, PDOException(code: 23000): SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails (`magentoprod`.`****_report_viewed_product_index`, CONSTRAINT `****_REPORT_VIEWED_PRD_IDX_PRD_ID_****_SEQUENCE_PRD_SEQUENCE_VAL` FOREIGN KEY (`product_id`) REFERENCES `****_sequence_product` (`) at /var/www/vendor/magento/zendframework1/library/Zend/Db/Statement/Pdo.php:228)"} []
######## SOLUTION 
Upgrade Wasn't Successful. re-upgrade


######## ISSUE WITH DATABASE
[2020-10-28 21:15:13] report.ERROR: Please upgrade your database: Run "bin/magento setup:upgrade" from the Magento root directory.
The following modules are outdated:
Dotdigitalgroup_Enterprise data: current version - none, required version - 1.0.2
MSP_TwoFactorAuth data: current version - 2.2.0, required version - 3.1.0
MSP_ReCaptcha data: current version - 1.5.0, required version - 1.6.0 [] []
######## SOLUTION 
Check the version of Module in Module config file, if it is up to date then update the data base table ***_setup_module change the current version manually.


UPGRADING FROM 2.3 to 2.4
######## ISSUE IN COMPOSER
[Sat Oct 31 20:27:41.367219 2020] [core:notice] [pid 742] AH00094: Command line: '/usr/sbin/apache2'
[Sat Oct 31 20:27:47.787886 2020] [php7:warn] [pid 745] [client 39.45.52.79:61132] PHP Warning:  "continue" targeting switch is equivalent to "break". Did you mean to use "continue 2"? in /var/www/html/vendor/zendframework/zend-stdlib/src/ArrayObject.php on line 426, referer:
######## SOLUTION
USE COMPOSER WITH PHP7.1




######### ISSUE WITH DATABASE
SQLSTATE[23000]: Integrity constraint violation: 1452 
Cannot add or update a child row: a foreign key constraint 
fails (`***rod`.`***_magento_salesrule_filter`, 
CONSTRAINT `FK_05955C1E7*****************2355E` FOREIGN KEY (`rule_id`) 
REFERENCES `***_sequence_salesrule` 
(`sequence_value`) ON DELETE CASCAD), query was: 
INSERT INTO `***_magento_salesrule_filter` (`rule_id`, `group_id`, `weight`, `filter_text`, `filter_text_generator_class`, `filter_text_generator_arguments`) VALUES (?, ?, ?, ?, ?, ?)
######## SOLUTIONRUN FOLLOWING SQL COMMAND
ALTER TABLE `***_magento_salesrule_filter` DROP FOREIGN KEY `FK_0***B20D2355E`
don't forget to replace the *** with real prefix


